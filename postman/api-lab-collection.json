{
  "info": {
    "_postman_id": "b86be02f-8fbd-4a5b-a6d3-e9b7ecbab64b",
    "name": "User API - Manual + Automation Ready",
    "description": "Organized Postman collection for /users API (PostgREST) with clear folders, role-based auth, and cleaned requests.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "23231928"
  },
  "item": [
    {
      "name": "01_HappyPath (Writer)",
      "item": [
        {
          "name": "getUsers",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  ""
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "packages": {},
                "type": "text/javascript"
              }
            }
          ],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "createUser",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "//converting response to json",
                  "let data = pm.response.json();",
                  "",
                  "//checking if response is an array",
                  "pm.test(\"Response is array\", function () {",
                  "    pm.expect(data).to.be.an(\"array\");",
                  "});",
                  "",
                  "//cheking if response has a user",
                  "pm.test(\"Response has at least one user\", function () {",
                  "    pm.expect(data.length).to.be.above(0);",
                  "});",
                  "",
                  "//selecting the first user",
                  "let user = data[0];",
                  "",
                  "//checking if user has id",
                  "pm.test(\"User has id\", function () {",
                  "    pm.expect(user).to.have.property(\"id\");",
                  "    pm.expect(user.id).to.be.a(\"number\");",
                  "});",
                  "",
                  "//Checking if email is correct and matches",
                  "pm.test(\"User email matches what we sent\", function () {",
                  "    pm.expect(user.email).to.equal(pm.environment.get(\"newUserEmail\"));",
                  "});",
                  "",
                  "//Saving user id in environment variable for future use.",
                  "pm.environment.set(\"userId\", user.id);",
                  "",
                  "pm.test(\"Saved userId in environment\", function () {",
                  "  pm.expect(pm.environment.get(\"userId\")).to.eql(user.id);",
                  "});"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "let randomNumber = Math.floor(Math.random() * 1000);",
                  "",
                  "let name = \"QA_\" + randomNumber;",
                  "let email = \"qa_\" + Date.now() + \"@test.com\";",
                  "",
                  "pm.environment.set(\"newUserName\", name);",
                  "pm.environment.set(\"newUserEmail\", email);",
                  ""
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"{{newUserName}}\",\n  \"email\": \"{{newUserEmail}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "updateUser",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Parse request and response body",
                  "const requestBody = JSON.parse(pm.request.body.raw);",
                  "const responseBody = pm.response.json();",
                  "",
                  "// Assert response status is 200",
                  "pm.test(\"Response status is 200\", function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "// Assert response has a name property (response is an array, check first element)",
                  "pm.test(\"Response has name property\", function() {",
                  "    pm.expect(responseBody[0]).to.have.property(\"name\");",
                  "});",
                  "",
                  "// Assert response name matches request body name",
                  "pm.test(\"Response name matches request body name\", function() {",
                  "    pm.expect(responseBody[0].name).to.eql(requestBody.name);",
                  "});"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "//setting dynamic variable for updatedName in environment variables",
                  "let updatedName = \"Updated_QA_\" + Date.now();",
                  "pm.environment.set(\"updatedName\", updatedName);"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"{{updatedName}}\"\n}\n",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.{{userId}}",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.{{userId}}"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "deleteUser",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "//Check if the user is deleted successfully",
                  "pm.test(\"Delete status is 200 or 204\", function () {",
                  "  pm.expect([200, 204]).to.include(pm.response.code);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "  const data = pm.response.json();",
                  "  pm.test(\"Delete returns array\", function () {",
                  "    pm.expect(data).to.be.an(\"array\");",
                  "  });",
                  "}",
                  ""
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  ""
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.{{userId}}",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.{{userId}}"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "confirmDeletion",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"User is deleted (empty array)\", function () {",
                  "  pm.expect(pm.response.code).to.equal(200);",
                  "  const data = pm.response.json();",
                  "  pm.expect(data).to.be.an(\"array\");",
                  "  pm.expect(data.length).to.equal(0);",
                  "});",
                  ""
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  ""
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.{{userId}}",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.{{userId}}"
                }
              ]
            }
          },
          "response": []
        }
      ],
      "auth": {
        "type": "bearer",
        "bearer": [
          {
            "key": "token",
            "value": "{{writerToken}}",
            "type": "string"
          }
        ]
      }
    },
    {
      "name": "02_Negative & Edge (Writer)",
      "item": [
        {
          "name": "nameMissing",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"niloy@test.com\"\n}\n",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "nameEmpty",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"\",\n  \"email\": \"niloy@test.com\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "emailDuplicate",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Niloy\",\n  \"email\": \"niloy@test.com\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "email-Invalid",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Maha\",\n  \"email\": \"maha\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "extraField",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\":\"x\",\n    \"email\":\"y\",\n    \"role\":\"admin\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "unknownColumn",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"ID\": 7,\n  \"name\": \"Maha\",\n  \"email\": \"maha\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "providedID",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": 99,\n  \"name\": \"Noorain\",\n  \"email\": \"noorain\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "autoIncrementID",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Automated User4\",\n  \"email\": \"auto4@test.com\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        }
      ],
      "auth": {
        "type": "bearer",
        "bearer": [
          {
            "key": "token",
            "value": "{{writerToken}}",
            "type": "string"
          }
        ]
      }
    },
    {
      "name": "03_Update & Delete (Writer)",
      "item": [
        {
          "name": "updateID",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Updated Name\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.9",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.9"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "updateName",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Razve\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.12",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.12"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "updateCreatedAt",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"created_at\": \"2000-01-01T00:00:00Z\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.12",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.12"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "userDeleteByID",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.5",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.5"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "userDeleteByName",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?name=eq.Noorain",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "name",
                  "value": "eq.Noorain"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "userDeleteByEmail",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?email=eq.noorain",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "email",
                  "value": "eq.noorain"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Delete a non-existent user",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.100",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.100"
                }
              ]
            }
          },
          "response": []
        }
      ],
      "auth": {
        "type": "bearer",
        "bearer": [
          {
            "key": "token",
            "value": "{{writerToken}}",
            "type": "string"
          }
        ]
      }
    },
    {
      "name": "04_Error Consistency (Writer)",
      "item": [
        {
          "name": "Bad filter syntax",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseURL}}/users?id=eq(12)",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq(12)"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Unknown column in payload",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \n    \"ID\": 7, \n    \"name\": \"X\", \n    \"email\": \"x@test.com\" \n}\n",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "NOT NULL violation",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \n    \"email\": \"noname@test.com\" \n}\n",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "UNIQUE violation",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \n    \"name\": \"Dup\", \n    \"email\": \"hasan@test.com\" \n}\n",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "PRIMARY KEY collision",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \n    \"id\": 15, \n    \"name\": \"PK Clash\", \n    \"email\": \"pkclash@test.com\" \n}\n",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Update target doesnâ€™t exist (observability)",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \n    \"name\": \"No such user\"\n}\n",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.99999",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.99999"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Duplicate email via PATCH",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \n    \"email\": \"hasan@test.com\"\n}\n",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.15",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.15"
                }
              ]
            }
          },
          "response": []
        }
      ],
      "auth": {
        "type": "bearer",
        "bearer": [
          {
            "key": "token",
            "value": "{{writerToken}}",
            "type": "string"
          }
        ]
      }
    },
    {
      "name": "06_Auth Matrix (Anon/Reader/Writer)",
      "item": [
        {
          "name": "GET_users__anon",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "GET_users__reader",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{readerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "GET_users__writer",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "GET_user_by_id__anon",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.11",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.11"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "GET_user_by_id__reader",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{readerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.11",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.11"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "GET_user_by_id__writer",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.11",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.11"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "POST_users__anon",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"anon user1\",\n    \"email\": \"anon1@test.com\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "POST_users__reader",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{readerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"anon user1\",\n    \"email\": \"anon1@test.com\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "POST_users__writer",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"anon user2\",\n    \"email\": \"anon2@test.com\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "PATCH_users__anon",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"maha@test.com\"\n}"
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.7",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.7"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "PATCH_users__reader",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{readerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"maha@test.com\"\n}"
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.7",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.7"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "PATCH_users__writer",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"maha@test.com\"\n}"
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.7",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.7"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "DEL_users__anon",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.18",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.18"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "DEL_users__reader",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{readerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.18",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.18"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "DEL_users__writer",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{writerToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Prefer",
                "value": "return=representation",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/users?id=eq.20",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "users"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "eq.20"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "07_Contract (Schema/Response Shape)",
      "item": [
        {
          "name": "Contract - Success",
          "item": [
            {
              "name": "GET_users__reader__contract_success",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status is 200', function () { pm.response.to.have.status(200); });",
                      "pm.test('Response is JSON array', function () {",
                      "  const data = pm.response.json();",
                      "  pm.expect(data).to.be.an('array');",
                      "});",
                      "pm.test('User contract keys + types (sample)', function () {",
                      "  const data = pm.response.json();",
                      "  if (!data.length) return;",
                      "  const u = data[0];",
                      "  pm.expect(u).to.have.property('id');",
                      "  pm.expect(u).to.have.property('name');",
                      "  pm.expect(u).to.have.property('email');",
                      "  pm.expect(u).to.have.property('created_at');",
                      "  pm.expect(u.id).to.be.a('number');",
                      "  pm.expect(u.name).to.be.a('string');",
                      "  pm.expect(u.email).to.be.a('string');",
                      "  pm.expect(u.created_at).to.satisfy(v => v === null || typeof v === 'string');",
                      "});"
                    ]
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{readerToken}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseURL}}/users",
                  "host": [
                    "{{baseURL}}"
                  ],
                  "path": [
                    "users"
                  ]
                }
              },
              "response": []
            },
            {
              "name": "GET_user_by_id__reader__contract_success_object",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status is 200', function () { pm.response.to.have.status(200); });",
                      "pm.test('Response is a JSON object', function () {",
                      "  const u = pm.response.json();",
                      "  pm.expect(u).to.be.an('object');",
                      "});",
                      "pm.test('User object contract keys + types', function () {",
                      "  const u = pm.response.json();",
                      "  pm.expect(u).to.have.property('id');",
                      "  pm.expect(u).to.have.property('name');",
                      "  pm.expect(u).to.have.property('email');",
                      "  pm.expect(u).to.have.property('created_at');",
                      "  pm.expect(u.id).to.be.a('number');",
                      "  pm.expect(u.name).to.be.a('string');",
                      "  pm.expect(u.email).to.be.a('string');",
                      "  pm.expect(u.created_at).to.satisfy(v => v === null || typeof v === 'string');",
                      "});"
                    ]
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{readerToken}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/vnd.pgrst.object+json",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{baseURL}}/users?id=eq.1",
                  "host": [
                    "{{baseURL}}"
                  ],
                  "path": [
                    "users"
                  ],
                  "query": [
                    {
                      "key": "id",
                      "value": "eq.1"
                    }
                  ]
                }
              },
              "response": []
            }
          ]
        },
        {
          "name": "Contract - Errors",
          "item": [
            {
              "name": "GET_users__anon__unauthorized_contract",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Anon is blocked (401/403)', function () {",
                      "  pm.expect([401, 403]).to.include(pm.response.code);",
                      "});",
                      "pm.test('Error response is JSON object', function () {",
                      "  const e = pm.response.json();",
                      "  pm.expect(e).to.be.an('object');",
                      "});",
                      "pm.test('Error has at least one expected field', function () {",
                      "  const e = pm.response.json();",
                      "  pm.expect(e.message || e.error || e.code || e.details).to.exist;",
                      "});"
                    ]
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseURL}}/users",
                  "host": [
                    "{{baseURL}}"
                  ],
                  "path": [
                    "users"
                  ]
                }
              },
              "response": []
            },
            {
              "name": "GET_user_by_id__reader__not_found_contract_404",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Not found returns 404', function () { pm.response.to.have.status(404); });",
                      "pm.test('Error response is JSON object', function () {",
                      "  const e = pm.response.json();",
                      "  pm.expect(e).to.be.an('object');",
                      "});",
                      "pm.test('Error contains PostgREST-style fields', function () {",
                      "  const e = pm.response.json();",
                      "  pm.expect(e.message || e.details || e.code).to.exist;",
                      "});"
                    ]
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{readerToken}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/vnd.pgrst.object+json",
                    "type": "text"
                  }
                ],
                "url": {
                  "raw": "{{baseURL}}/users?id=eq.999999",
                  "host": [
                    "{{baseURL}}"
                  ],
                  "path": [
                    "users"
                  ],
                  "query": [
                    {
                      "key": "id",
                      "value": "eq.999999"
                    }
                  ]
                }
              },
              "response": []
            },
            {
              "name": "POST_users__writer__duplicate_email_contract_409",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Duplicate email returns 409', function () { pm.response.to.have.status(409); });",
                      "pm.test('Error response is JSON', function () { pm.response.to.be.json; });",
                      "pm.test('Error response is object (not array)', function () {",
                      "  const e = pm.response.json();",
                      "  pm.expect(e).to.be.an('object');",
                      "});"
                    ]
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{writerToken}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json",
                    "type": "text"
                  },
                  {
                    "key": "Prefer",
                    "value": "return=representation",
                    "type": "text"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"Dup Email\",\n  \"email\": \"auto2@test.com\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{baseURL}}/users",
                  "host": [
                    "{{baseURL}}"
                  ],
                  "path": [
                    "users"
                  ]
                }
              },
              "response": []
            }
          ]
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseURL",
      "value": "",
      "type": "default"
    }
  ]
}